!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.OFDView=t():e.OFDView=t()}(self,(()=>(({371:function(){$("#openFile").click((function(){!function(){this.isFont=!1,this.file=null,$("#file")[0].click()}()})),$("#file").change((function(){!function(){if(this.file=$("#file")[0].files[0],null!=this.file){var e=this.file.name.replace(/.+\./,"");if(-1!==["ofd"].indexOf(e))if(this.file.size>10485760)this.alert("文件大小超过10MB！");else{Object(cnofd.setScaleValue)(this.pageZoomScale);var t=document.getElementById("zoomValue");t&&(t.value=this.pageZoomScale);var n=this,o=new FileReader;o.readAsDataURL(this.file),o.onload=function(e){n.ofdBase64=e.target.result.split(",")[1]},this.getOfdDocument(this.file,this.screenWidth,this.pageZoomScale)}else this.alert("仅支持ofd文件类型！")}}()})),$("#zoomIn").click((function(){!function(){var e=document.getElementById("zoomValue");if(e.selectedIndex>1){e.selectedIndex=e.selectedIndex-1,Object(cnofd.setScaleValue)(e.options[e.selectedIndex].value);var t=Object(cnofd.ofdRenderByScale)(this.ofdDoc);t?this.displayOfdDiv(t):this.getOfdDocument(this.file,this.screenWidth)}}()})),$("#zoomOut").click((function(){!function(){var e=document.getElementById("zoomValue");if(e.selectedIndex<e.length-1){e.selectedIndex=e.selectedIndex+1,0==e.selectedIndex&&(e.selectedIndex=1),Object(cnofd.setScaleValue)(e.options[e.selectedIndex].value);var t=Object(cnofd.ofdRenderByScale)(this.ofdDoc);t?this.displayOfdDiv(t):this.getOfdDocument(this.file,this.screenWidth)}}()})),$("#zoomValue").change((function(){!function(){var e,t=document.getElementById("zoomValue");"width"==t.options[t.selectedIndex].value?(Object(cnofd.setScaleValue)(t.options[t.selectedIndex].value),(e=Object(cnofd.ofdRender)(this.ofdDoc,this.screenWidth))?this.displayOfdDiv(e):this.getOfdDocument(this.file,this.screenWidth)):(Object(cnofd.setScaleValue)(t.options[t.selectedIndex].value),(e=Object(cnofd.ofdRenderByScale)(this.ofdDoc))?this.displayOfdDiv(e):this.getOfdDocument(this.file,this.screenWidth))}()})),$("#firstPage").click((function(){!function(){var e=document.getElementById("content").firstElementChild;null==e||e.scrollIntoView(!0),e&&(this.pageIndex=1),i()}()})),$("#prePage").click((function(){!function(){var e=document.getElementById("content").children.item(this.pageIndex-2);null==e||e.scrollIntoView(!0),e&&(this.pageIndex=this.pageIndex-1),i()}()})),$("#nextPage").click((function(){!function(){var e=document.getElementById("content").children.item(this.pageIndex);null==e||e.scrollIntoView(!0),e&&++this.pageIndex,i()}()})),$("#lastPage").click((function(){!function(){var e=document.getElementById("content"),t=e.children.item(e.childElementCount-1);null==t||t.scrollIntoView(!0),t&&(this.pageIndex=e.childElementCount),i()}()})),$("#print").click((function(){!function(){for(var e=document.getElementById("content").children,t=[],n=0;n<e.length;n++){var o=e.item(n);t.push(o.cloneNode(!0)),this.percentage=n/e.length}if(t.length>0)if((r=window.navigator.userAgent).indexOf("MSIE")>0||r.indexOf("Trident")>0){var i="";for(n=0;n<t.length;n++)(s=t[n]).style.margin="",s.style.boxShadow="",i+=s.outerHTML;!function(e){var t=document.createElement("iframe");t.id="printf",t.style.width="0",t.style.display="none",t.style.height="0",t.style.border="none",document.body.appendChild(t),setTimeout((function(){t.contentDocument.write(" <script type='text/javascript'>  window.onload = function() { document.execCommand('print'); } <\/script> "+e),t.contentDocument.close()}),100)}(i)}else{var l=window.open("打印窗口","_blank");l.document.write('<!DOCTYPE html><html><head><style media="print">.page-break { page-break-inside: avoid; page-break-after: always; }</style></head><body></body</html>');var d,c=l.document.body,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){c=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(c)throw l}}}}(t);try{for(a.s();!(d=a.n()).done;){var s;(s=d.value).style.margin="",s.style.boxShadow="",c.appendChild(s)}}catch(e){a.e(e)}finally{a.f()}l.focus(),l.print(),l.close()}var r}()})),$("#main").scroll((function(){!function(){for(var e=document.getElementById("content"),t=e.firstElementChild,n=(null==t||null===t.getBoundingClientRect()||void 0===t.getBoundingClientRect()?void 0:t.getBoundingClientRect().top)-60,o=0,l=0,d=0;d<e.childElementCount;d++){var c=e.children.item(d);if(o+=Math.abs(null==c?void 0:c.style.height.replace("px",""))+Math.abs(null==c?void 0:c.style.marginBottom.replace("px","")),Math.abs(n)<o){l=d;break}}this.pageIndex=l+1,i()}()})),window.onresize=function(){var e;(e=document.getElementById("content")).childNodes[0]&&e.childNodes[0].offsetLeft},document.addEventListener("copy",(function(e){if(!e.clipboardData&&!window.clipboardData)return;let t=window.getSelection().toString();if(t){var n=t.replace(/\n|\r/g,"");if(window.clipboardData)window.clipboardData.setData("Text",n);else{var o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px";var i=document.getElementsByTagName("body")[0];i.appendChild(o),o.innerHTML=n,window.getSelection().selectAllChildren(o),window.setTimeout((function(){i.removeChild(o)}),0)}}})),this.isMobile()&&(document.getElementById("zoomSelect")&&(document.getElementById("zoomSelect").style.display="none"),document.getElementById("openFile")&&(document.getElementById("openFile").style.display="none"),document.getElementById("print")&&(document.getElementById("print").style.display="none"),document.getElementById("separator1")&&(document.getElementById("separator1").style.display="none"),document.getElementById("separator2")&&(document.getElementById("separator2").style.display="none")),this.screenWidth=document.body.clientWidth,this.pageZoomScale="1.0",cnofd.setScaleValue(this.pageZoomScale);var e=this.getQueryVariable("scale");e&&("width"==e||Number(e))&&(this.pageZoomScale=e,cnofd.setScaleValue(e));var t=this.getQueryVariable("file");if(t&&this.loadOfdFile(t),e&&("width"==e||Number(e))){var n=document.getElementById("zoomValue");if(n.selectedIndex=-1,"width"==this.pageZoomScale)n.selectedIndex=0;else for(var o=1;o<n.length;o++)if(Math.abs(this.pageZoomScale-n.options[o].value)<.01){n.selectedIndex=o;break}}function i(){null!=this.pageCount&&this.pageCount>0&&($("#pageInfo")[0].innerText=this.pageIndex+"/"+this.pageCount)}}}[371](),{}))));